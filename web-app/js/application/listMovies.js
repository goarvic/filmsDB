//*********************************************************************************************
//*********************************************************************************************
//*********************************************************************************************

var searchWord
var urlSearchMovies
var urlChangeSortMovies
var urlApplyFilterMovies

//*********************************************************************************************
//*********************************************************************************************
//*********************************************************************************************


$(document).ready(
	function()
	{
		hideControlsAttendingToPath()
		setSearchInputText()
		setButtonSearchProperties()
	}
);


//*********************************************************************************************
//*********************************************************************************************
//*********************************************************************************************

function setSearchInputText()
{
	if ((searchWord != "") && (searchWord != null))
	{
		$('#searchMovies').val(searchWord)
	}
}


//*********************************************************************************************
//*********************************************************************************************
//*********************************************************************************************

function hideControlsAttendingToPath()
{
	var pathname = window.location.pathname;

	if (pathname.indexOf("search")>0)
	{
		$('#sortDiv').hide()
		$('#filterDiv').hide()
	}
}


//*********************************************************************************************
//*********************************************************************************************
//*********************************************************************************************


function setButtonSearchProperties()
{
	if ($('#searchMovies').val().length < 3)
		$('#buttonSearch').attr("disabled", true)
	else
		$('#buttonSearch').removeAttr("disabled")


	$('#searchMovies').keyup(function(e){
		if ($('#searchMovies').val().length < 3)
			$('#buttonSearch').attr("disabled", true)
		else
			$('#buttonSearch').removeAttr("disabled")

		if(e.which == 13)
		{
			searchMovie(urlSearchMovies)
		}
	});
}


//*********************************************************************************************
//*********************************************************************************************
//*********************************************************************************************


$(document).on( 'click', '#buttonSearch',
	function()
	{
		searchMovie(urlSearchMovies)
	}
);

//*********************************************************************************************
//*********************************************************************************************
//*********************************************************************************************

$(document).on( 'change', '#sortMovies',
	function()
	{
		var url = urlChangeSortMovies
		var order
		$('#sortMovies option:selected').each(function() {
			order = $( this ).val()
		})
		url+="?order=" + order
		window.location.href=url
	}
);



//*********************************************************************************************
//*********************************************************************************************
//*********************************************************************************************

$(document).on( 'change', '#filterMovies',
	function()
	{
		var url = urlApplyFilterMovies
		var filter
		$('#filterMovies option:selected').each(function() {
			filter = $( this ).val()
		})
		url+="?filterGenre=" + filter
		window.location.href=url
	}
);


//*********************************************************************************************
//*********************************************************************************************
//*********************************************************************************************


function searchMovie(url)
{
	var search = $('#searchMovies').val()
	var urlWithParams = url + "?search=" + search

	if (search.length > 2)
		window.location.href = urlWithParams
}

//*********************************************************************************************
//*********************************************************************************************
//*********************************************************************************************

